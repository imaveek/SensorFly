/*
 * PID.cpp
 *
 *  Created on: Apr 4, 2012
 *      Author: imaveek
 */

#include "PID.h"

PID::PID() {
	// TODO Auto-generated constructor stub

}

float PID::loop(float setpoint, float actual_position) {

	float output=0;

	//Calculate P,I,D
	error = setpoint - actual_position;

	//In case of error too small then stop integration
	if(abs(error) > epsilon)
	{
		integral = integral + error*dt;
	}
	derivative = (error - pre_error)/dt;
	output = yawKp*error + yawKi*integral + yawKd*derivative;

	//Saturation Filter
	if(output > yawMAX)
	{
		output = yawMAX;
	}
	else if(output < yawMIN)
	{
		output = yawMIN;
	}

	//Update error
	pre_error = error;

	return output;
}

PID::~PID() {
	// TODO Auto-generated destructor stub
}

